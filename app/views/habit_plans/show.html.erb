<% content_for :vite_page, true %>
<% content_for :main_container_class, 'w-full bg-base-200 min-h-screen' %>

<div class="container mx-auto px-4 py-8 max-w-7xl">
  <%= render 'shared/flash' if flash.any? %>

  <% if @habit_plan.nil? %>
    <!-- No Plan Found for Selected Duration -->
    <div class="min-h-screen bg-base-200 flex items-center justify-center">
      <div class="card bg-base-100 shadow-xl max-w-md">
        <div class="card-body text-center">
          <h2 class="card-title text-2xl justify-center mb-4">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-warning" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
            </svg>
          </h2>
          <h3 class="text-xl font-semibold mb-2">No <%= @duration_type.titleize %> Plan Found</h3>
          <p class="text-base-content/70 mb-4">You don't have a <%= @duration_type.titleize %> habit plan yet.</p>
          <%= link_to "Back to Dashboard", dashboard_path, class: "btn btn-primary" %>
        </div>
      </div>
    </div>
  <% else %>
    <!-- Enhanced Habit Plan Header -->
    <div class="mb-8">
      <!-- MindFlow Header -->
      <div class="relative mb-8">
        <!-- Clean Navigation Bar -->
        <div class="flex items-center justify-between mb-6">
          <div class="flex items-center gap-4">
            <div class="flex items-center gap-3">
              <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-blue-500 to-emerald-500 flex items-center justify-center">
                <span class="text-white font-bold text-lg">MF</span>
              </div>
              <h1 class="text-2xl font-bold text-base-content">MindFlow</h1>
            </div>
            <div class="hidden md:flex items-center gap-1 text-sm text-base-content/60">
              <span>Biohacking Dashboard</span>
              <div class="w-1 h-1 rounded-full bg-emerald-500"></div>
              <span>Live</span>
            </div>
          </div>
          
          <div class="flex items-center gap-4">
            <div class="text-right">
              <div class="text-sm font-medium text-base-content">
                <%= case Time.current.hour
                    when 5..11 then "Morning Optimization"
                    when 12..17 then "Peak Performance"
                    when 18..21 then "Evening Recovery"
                    else "Biohacking Protocol"
                    end %>
              </div>
              <div class="text-xs text-base-content/60"><%= Time.current.strftime("%A, %B %d") %></div>
            </div>
            <%= link_to dashboard_path, class: "w-8 h-8 rounded-full bg-gradient-to-br from-blue-500 to-emerald-500 flex items-center justify-center text-white hover:scale-105 transition-transform" do %>
              <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor">
                <path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z" />
              </svg>
            <% end %>
          </div>
        </div>

        <!-- Biohacking Stats Overview -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
          <!-- Focus Score Card -->
          <div class="card backdrop-blur-xl border border-blue-400/30 shadow-lg hover:shadow-blue-500/20 transition-all relative overflow-hidden" style="background: linear-gradient(135deg, rgba(59, 130, 246, 0.15) 0%, rgba(147, 51, 234, 0.15) 50%, rgba(236, 72, 153, 0.15) 100%), url('data:image/svg+xml,%3Csvg width=&quot;100&quot; height=&quot;100&quot; viewBox=&quot;0 0 100 100&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot;%3E%3Cdefs%3E%3ClinearGradient id=&quot;glow1&quot; x1=&quot;0%25&quot; y1=&quot;0%25&quot; x2=&quot;100%25&quot; y2=&quot;100%25&quot;%3E%3Cstop offset=&quot;0%25&quot; style=&quot;stop-color:%2300d4ff;stop-opacity:0.8&quot; /%3E%3Cstop offset=&quot;100%25&quot; style=&quot;stop-color:%236366f1;stop-opacity:0.6&quot; /%3E%3C/linearGradient%3E%3ClinearGradient id=&quot;glow2&quot; x1=&quot;0%25&quot; y1=&quot;100%25&quot; x2=&quot;100%25&quot; y2=&quot;0%25&quot;%3E%3Cstop offset=&quot;0%25&quot; style=&quot;stop-color:%23a855f7;stop-opacity:0.7&quot; /%3E%3Cstop offset=&quot;100%25&quot; style=&quot;stop-color:%23ec4899;stop-opacity:0.5&quot; /%3E%3C/linearGradient%3E%3C/defs%3E%3Cg fill=&quot;none&quot; stroke-width=&quot;0.5&quot;%3E%3Cpath d=&quot;M10,20 Q30,10 50,30 T90,25 Q70,45 30,40 T5,35&quot; stroke=&quot;url(%23glow1)&quot; opacity=&quot;0.6&quot; /%3E%3Cpath d=&quot;M15,80 Q35,70 55,90 T95,85 Q75,65 35,70 T10,65&quot; stroke=&quot;url(%23glow2)&quot; opacity=&quot;0.7&quot; /%3E%3Cpath d=&quot;M20,50 Q40,40 60,60 T100,55 Q80,75 40,70 T15,65&quot; stroke=&quot;url(%23glow1)&quot; opacity=&quot;0.5&quot; /%3E%3Cpath d=&quot;M5,70 Q25,60 45,80 T85,75 Q65,95 25,90 T0,85&quot; stroke=&quot;url(%23glow2)&quot; opacity=&quot;0.6&quot; /%3E%3Cpath d=&quot;M25,10 Q45,0 65,20 T105,15 Q85,35 45,30 T20,25&quot; stroke=&quot;url(%23glow1)&quot; opacity=&quot;0.7&quot; /%3E%3Cpath d=&quot;M0,40 Q20,30 40,50 T80,45 Q60,65 20,60 T-5,55&quot; stroke=&quot;url(%23glow2)&quot; opacity=&quot;0.5&quot; /%3E%3C/g%3E%3C/svg%3E'); background-size: cover; background-position: center;">
            <div class="card-body p-6 text-center relative" style="z-index: 10;">
              <div class="text-sm text-white font-semibold mb-2 drop-shadow-lg" style="text-shadow: 0 1px 3px rgba(0,0,0,0.5);">Focus Index</div>
              <div class="relative w-24 h-24 mx-auto mb-3">
                <svg class="w-24 h-24 transform -rotate-90" viewBox="0 0 36 36">
                  <path
                    d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"
                    fill="none"
                    stroke="currentColor"
                    strokeWidth="2"
                    strokeDasharray="100, 100"
                    class="text-base-300"
                  />
                  <path
                    d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"
                    fill="none"
                    stroke="url(#focusGradient)"
                    strokeWidth="2"
                    strokeDasharray="85, 100"
                    class="drop-shadow-sm"
                  />
                  <defs>
                    <linearGradient id="focusGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                      <stop offset="0%" stopColor="#3B82F6" />
                      <stop offset="100%" stopColor="#10B981" />
                    </linearGradient>
                  </defs>
                </svg>
                <div class="absolute inset-0 flex items-center justify-center">
                  <span class="text-2xl font-bold text-base-content">85%</span>
                </div>
              </div>
              <div class="text-xs text-emerald-500 flex items-center justify-center gap-1">
                <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd" />
                </svg>
                <span>↑ 8% from yesterday</span>
              </div>
            </div>
          </div>

          <!-- Streak Overview -->
          <div class="card backdrop-blur-xl border border-emerald-400/30 shadow-lg hover:shadow-emerald-500/20 transition-all relative overflow-hidden" style="background: linear-gradient(135deg, rgba(16, 185, 129, 0.15) 0%, rgba(34, 197, 94, 0.15) 50%, rgba(59, 130, 246, 0.15) 100%), url('data:image/svg+xml,%3Csvg width=&quot;100&quot; height=&quot;100&quot; viewBox=&quot;0 0 100 100&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot;%3E%3Cdefs%3E%3ClinearGradient id=&quot;skyGradient&quot; x1=&quot;0%25&quot; y1=&quot;0%25&quot; x2=&quot;0%25&quot; y2=&quot;100%25&quot;%3E%3Cstop offset=&quot;0%25&quot; style=&quot;stop-color:%23064748;stop-opacity:0.8&quot; /%3E%3Cstop offset=&quot;25%25&quot; style=&quot;stop-color:%230e7490;stop-opacity:0.6&quot; /%3E%3Cstop offset=&quot;50%25&quot; style=&quot;stop-color:%23fb923c;stop-opacity:0.5&quot; /%3E%3Cstop offset=&quot;75%25&quot; style=&quot;stop-color:%23ea580c;stop-opacity:0.7&quot; /%3E%3Cstop offset=&quot;100%25&quot; style=&quot;stop-color:%23dc2626;stop-opacity:0.6&quot; /%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width=&quot;100&quot; height=&quot;100&quot; fill=&quot;url(%23skyGradient)&quot; /%3E%3C!-- Mountain silhouettes --%3E%3Cg fill=&quot;%23000000&quot; fill-opacity=&quot;0.8&quot;%3E%3Cpath d=&quot;M0,70 L15,60 L25,65 L35,55 L45,60 L55,50 L65,55 L75,45 L85,50 L100,45 L100,100 L0,100 Z&quot; /%3E%3Cpath d=&quot;M0,75 L10,70 L20,75 L30,65 L40,70 L50,60 L60,65 L70,55 L80,60 L90,55 L100,60 L100,100 L0,100 Z&quot; opacity=&quot;0.6&quot; /%3E%3C/g%3E%3C!-- Sun --%3E%3Ccircle cx=&quot;50&quot; cy=&quot;50&quot; r=&quot;8&quot; fill=&quot;%23ffffff&quot; opacity=&quot;0.9&quot; /%3E%3Ccircle cx=&quot;50&quot; cy=&quot;50&quot; r=&quot;6&quot; fill=&quot;%23fb923c&quot; opacity=&quot;0.8&quot; /%3E%3C!-- Foreground valley --%3E%3Crect x=&quot;0&quot; y=&quot;85&quot; width=&quot;100&quot; height=&quot;15&quot; fill=&quot;%23000000&quot; fill-opacity=&quot;0.9&quot; /%3E%3C/svg%3E'); background-size: cover; background-position: center;">
            <div class="card-body p-6 relative" style="z-index: 10;">
              <div class="text-sm text-white font-semibold mb-4 drop-shadow-lg" style="text-shadow: 0 1px 3px rgba(0,0,0,0.5);">Habit Streaks</div>
              <div class="space-y-3">
                <div class="flex items-center justify-between">
                  <div class="flex items-center gap-2">
                    <span class="text-lg">🧘‍♂️</span>
                    <span class="text-sm font-medium">Meditation</span>
                  </div>
                  <div class="text-right">
                    <div class="text-sm font-bold text-base-content">12d</div>
                    <div class="w-16 h-1 bg-base-300 rounded-full">
                      <div class="h-full bg-emerald-500 rounded-full" style="width: 90%"></div>
                    </div>
                  </div>
                </div>
                <div class="flex items-center justify-between">
                  <div class="flex items-center gap-2">
                    <span class="text-lg">✍️</span>
                    <span class="text-sm font-medium">Journaling</span>
                  </div>
                  <div class="text-right">
                    <div class="text-sm font-bold text-base-content">8d</div>
                    <div class="w-16 h-1 bg-base-300 rounded-full">
                      <div class="h-full bg-blue-500 rounded-full" style="width: 75%"></div>
                    </div>
                  </div>
                </div>
                <div class="flex items-center justify-between">
                  <div class="flex items-center gap-2">
                    <span class="text-lg">💧</span>
                    <span class="text-sm font-medium">Hydration</span>
                  </div>
                  <div class="text-right">
                    <div class="text-sm font-bold text-base-content">15d</div>
                    <div class="w-16 h-1 bg-base-300 rounded-full">
                      <div class="h-full bg-blue-400 rounded-full" style="width: 95%"></div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Weekly Trend -->
          <div class="card backdrop-blur-xl border border-blue-400/30 shadow-lg hover:shadow-blue-500/20 transition-all relative overflow-hidden" style="background: linear-gradient(135deg, rgba(30, 27, 75, 0.9) 0%, rgba(67, 56, 202, 0.8) 25%, rgba(139, 92, 246, 0.7) 50%, rgba(236, 72, 153, 0.6) 75%, rgba(251, 146, 60, 0.5) 100%), url('data:image/svg+xml,%3Csvg width=&quot;400&quot; height=&quot;400&quot; viewBox=&quot;0 0 400 400&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot;%3E%3Cdefs%3E%3CradialGradient id=&quot;orb1&quot; cx=&quot;50%25&quot; cy=&quot;50%25&quot; r=&quot;50%25&quot;%3E%3Cstop offset=&quot;0%25&quot; style=&quot;stop-color:%23ec4899;stop-opacity:0.8&quot; /%3E%3Cstop offset=&quot;50%25&quot; style=&quot;stop-color:%23a855f7;stop-opacity:0.4&quot; /%3E%3Cstop offset=&quot;100%25&quot; style=&quot;stop-color:%23ec4899;stop-opacity:0.1&quot; /%3E%3C/radialGradient%3E%3CradialGradient id=&quot;orb2&quot; cx=&quot;50%25&quot; cy=&quot;50%25&quot; r=&quot;50%25&quot;%3E%3Cstop offset=&quot;0%25&quot; style=&quot;stop-color:%2343a5f5;stop-opacity:0.7&quot; /%3E%3Cstop offset=&quot;50%25&quot; style=&quot;stop-color:%230ea5e9;stop-opacity:0.3&quot; /%3E%3Cstop offset=&quot;100%25&quot; style=&quot;stop-color:%2343a5f5;stop-opacity:0.1&quot; /%3E%3C/radialGradient%3E%3CradialGradient id=&quot;orb3&quot; cx=&quot;50%25&quot; cy=&quot;50%25&quot; r=&quot;50%25&quot;%3E%3Cstop offset=&quot;0%25&quot; style=&quot;stop-color:%23fbbf24;stop-opacity:0.6&quot; /%3E%3Cstop offset=&quot;50%25&quot; style=&quot;stop-color:%23f59e0b;stop-opacity:0.3&quot; /%3E%3Cstop offset=&quot;100%25&quot; style=&quot;stop-color:%23fbbf24;stop-opacity:0.1&quot; /%3E%3C/radialGradient%3E%3CradialGradient id=&quot;nebula1&quot; cx=&quot;30%25&quot; cy=&quot;40%25&quot; r=&quot;80%25&quot;%3E%3Cstop offset=&quot;0%25&quot; style=&quot;stop-color:%23ec4899;stop-opacity:0.4&quot; /%3E%3Cstop offset=&quot;30%25&quot; style=&quot;stop-color:%23a855f7;stop-opacity:0.3&quot; /%3E%3Cstop offset=&quot;70%25&quot; style=&quot;stop-color:%2343a5f5;stop-opacity:0.2&quot; /%3E%3Cstop offset=&quot;100%25&quot; style=&quot;stop-color:%230ea5e9;stop-opacity:0.05&quot; /%3E%3C/radialGradient%3E%3CradialGradient id=&quot;nebula2&quot; cx=&quot;70%25&quot; cy=&quot;60%25&quot; r=&quot;70%25&quot;%3E%3Cstop offset=&quot;0%25&quot; style=&quot;stop-color:%23f59e0b;stop-opacity:0.3&quot; /%3E%3Cstop offset=&quot;40%25&quot; style=&quot;stop-color:%23ef4444;stop-opacity:0.25&quot; /%3E%3Cstop offset=&quot;80%25&quot; style=&quot;stop-color:%238b5cf6;stop-opacity:0.15&quot; /%3E%3Cstop offset=&quot;100%25&quot; style=&quot;stop-color:%233b82f6;stop-opacity:0.05&quot; /%3E%3C/radialGradient%3E%3CradialGradient id=&quot;nebula3&quot; cx=&quot;50%25&quot; cy=&quot;20%25&quot; r=&quot;90%25&quot;%3E%3Cstop offset=&quot;0%25&quot; style=&quot;stop-color:%23fbbf24;stop-opacity:0.3&quot; /%3E%3Cstop offset=&quot;50%25&quot; style=&quot;stop-color:%23ec4899;stop-opacity:0.2&quot; /%3E%3Cstop offset=&quot;100%25&quot; style=&quot;stop-color:%236366f1;stop-opacity:0.05&quot; /%3E%3C/radialGradient%3E%3C/defs%3E%3C!-- Flowing nebula clouds --%3E%3Cpath d=&quot;M50,100 Q150,50 250,80 Q350,120 380,200 Q320,280 200,320 Q80,300 20,220 Q30,150 50,100&quot; fill=&quot;url(%23nebula1)&quot; opacity=&quot;0.6&quot; /%3E%3Cpath d=&quot;M100,50 Q200,80 300,60 Q380,100 360,180 Q300,260 180,290 Q60,280 40,200 Q50,120 100,50&quot; fill=&quot;url(%23nebula2)&quot; opacity=&quot;0.5&quot; /%3E%3Cpath d=&quot;M0,150 Q100,120 200,140 Q300,160 380,200 Q350,280 250,350 Q150,340 50,300 Q10,230 0,150&quot; fill=&quot;url(%23nebula3)&quot; opacity=&quot;0.4&quot; /%3E%3C!-- Floating orbs --%3E%3Ccircle cx=&quot;80&quot; cy=&quot;120&quot; r=&quot;25&quot; fill=&quot;url(%23orb1)&quot; opacity=&quot;0.6&quot; /%3E%3Ccircle cx=&quot;320&quot; cy=&quot;80&quot; r=&quot;30&quot; fill=&quot;url(%23orb2)&quot; opacity=&quot;0.5&quot; /%3E%3Ccircle cx=&quot;180&quot; cy=&quot;200&quot; r=&quot;20&quot; fill=&quot;url(%23orb3)&quot; opacity=&quot;0.7&quot; /%3E%3Ccircle cx=&quot;300&quot; cy=&quot;280&quot; r=&quot;35&quot; fill=&quot;url(%23orb1)&quot; opacity=&quot;0.4&quot; /%3E%3Ccircle cx=&quot;60&quot; cy=&quot;300&quot; r=&quot;22&quot; fill=&quot;url(%23orb2)&quot; opacity=&quot;0.5&quot; /%3E%3Ccircle cx=&quot;240&quot; cy=&quot;320&quot; r=&quot;28&quot; fill=&quot;url(%23orb3)&quot; opacity=&quot;0.6&quot; /%3E%3Ccircle cx=&quot;140&quot; cy=&quot;60&quot; r=&quot;18&quot; fill=&quot;url(%23orb1)&quot; opacity=&quot;0.5&quot; /%3E%3Ccircle cx=&quot;360&quot; cy=&quot;180&quot; r=&quot;32&quot; fill=&quot;url(%23orb2)&quot; opacity=&quot;0.4&quot; /%3E%3Ccircle cx=&quot;120&quot; cy=&quot;280&quot; r=&quot;24&quot; fill=&quot;url(%23orb3)&quot; opacity=&quot;0.6&quot; /%3E%3Ccircle cx=&quot;280&quot; cy=&quot;40&quot; r=&quot;26&quot; fill=&quot;url(%23orb1)&quot; opacity=&quot;0.5&quot; /%3E%3Ccircle cx=&quot;40&quot; cy=&quot;240&quot; r=&quot;20&quot; fill=&quot;url(%23orb2)&quot; opacity=&quot;0.4&quot; /%3E%3Ccircle cx=&quot;200&quot; cy=&quot;360&quot; r=&quot;30&quot; fill=&quot;url(%23orb3)&quot; opacity=&quot;0.5&quot; /%3E%3Ccircle cx=&quot;350&quot; cy=&quot;300&quot; r=&quot;22&quot; fill=&quot;url(%23orb1)&quot; opacity=&quot;0.4&quot; /%3E%3Ccircle cx=&quot;90&quot; cy=&quot;40&quot; r=&quot;16&quot; fill=&quot;url(%23orb2)&quot; opacity=&quot;0.5&quot; /%3E%3Ccircle cx=&quot;340&quot; cy=&quot;120&quot; r=&quot;28&quot; fill=&quot;url(%23orb3)&quot; opacity=&quot;0.6&quot; /%3E%3Ccircle cx=&quot;160&quot; cy=&quot;140&quot; r=&quot;24&quot; fill=&quot;url(%23orb1)&quot; opacity=&quot;0.5&quot; /%3E%3Ccircle cx=&quot;380&quot; cy=&quot;240&quot; r=&quot;26&quot; fill=&quot;url(%23orb2)&quot; opacity=&quot;0.4&quot; /%3E%3Ccircle cx=&quot;20&quot; cy=&quot;160&quot; r=&quot;18&quot; fill=&quot;url(%23orb3)&quot; opacity=&quot;0.5&quot; /%3E%3C!-- Subtle cosmic dust --%3E%3Cg fill=&quot;rgba(255,255,255,0.03)&quot;%3E%3Cellipse cx=&quot;200&quot; cy=&quot;200&quot; rx=&quot;250&quot; ry=&quot;180&quot; opacity=&quot;0.3&quot; /%3E%3Cellipse cx=&quot;100&quot; cy=&quot;250&quot; rx=&quot;200&quot; ry=&quot;120&quot; opacity=&quot;0.2&quot; /%3E%3Cellipse cx=&quot;300&quot; cy=&quot;150&quot; rx=&quot;180&quot; ry=&quot;200&quot; opacity=&quot;0.25&quot; /%3E%3C/g%3E%3C/svg%3E'); background-size: cover; background-position: center; z-index: 1;">
            <div class="card-body p-6 relative" style="z-index: 10;">
              <div class="text-sm text-white font-semibold mb-4 drop-shadow-lg" style="text-shadow: 0 1px 3px rgba(0,0,0,0.5);">Weekly Trends</div>
              <div class="h-20 relative" id="weekly-trends-chart">
                <!-- Modern Chart will be rendered here by React -->
                <div class="absolute bottom-0 left-0 text-xs text-white font-medium drop-shadow-lg" style="text-shadow: 0 1px 2px rgba(0,0,0,0.7);">Focus vs Calm</div>
              </div>
            </div>
          </div>
        </div>
      </div>

    </div>

    <!-- Mini Analytics Bar -->
    <div class="mb-6">
      <div class="bg-base-100/80 backdrop-blur-xl rounded-2xl p-6 border border-base-300/50 shadow-lg">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
          <div class="text-center">
            <div class="text-3xl font-bold text-primary" id="focus-minutes">247</div>
            <div class="text-sm text-base-content/70">Focus Minutes</div>
          </div>
          <div class="text-center">
            <div class="text-3xl font-bold text-green-500" id="weekly-percentage">92%</div>
            <div class="text-sm text-base-content/70">This Week</div>
          </div>
          <div class="text-center">
            <div class="text-3xl font-bold text-blue-500" id="total-habits">18</div>
            <div class="text-sm text-base-content/70">Total Habits</div>
          </div>
          <div class="text-center">
            <div class="text-3xl font-bold text-purple-500" id="completion-rate">85%</div>
            <div class="text-sm text-base-content/70">Completion Rate</div>
          </div>
        </div>
      </div>
    </div>


    <!-- React Habit Plan Component -->
    <div id="habit-plan-root" 
         data-props="<%= {
           habitPlan: {
             id: @habit_plan.id,
             name: @habit_plan.name,
             description: @habit_plan.description,
             duration_type: @habit_plan.duration_type,
             current_streak: @habit_plan.current_streak,
             next_milestone: @habit_plan.next_milestone,
             plan_sections: @habit_plan.plan_sections.map { |section|
               {
                 id: section.id,
                 name: section.name,
                 plan_items: section.plan_items.map { |item|
                   {
                     id: item.id,
                     content: item.content
                   }
                 }
               }
             }
           },
           habitLog: @habit_log ? {
             id: @habit_log.id,
             date: @habit_log.date,
             completed_at: @habit_log.completed_at,
             plan_item_logs: @habit_log.plan_item_logs.map { |log|
               {
                 plan_item_id: log.plan_item_id,
                 completed_at: log.completed_at
               }
             }
           } : nil,
           date: @date,
           sectionPresenters: @section_presenters || []
         }.to_json.gsub("'", "&#39;") %>">
    </div>

  <% end %>
</div>

<%= vite_javascript_tag 'habit_plan.jsx' %>

