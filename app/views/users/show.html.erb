<%#
    This sets the classes for the main layout container.
    It will grow, have a background color, and center its content.
  %>
<% content_for :main_container_class, 'flex-1 flex justify-center items-stretch bg-base-200 p-8' %>

<%#
    This is our custom card.
    Because its parent (<main>) has 'items-stretch', this card will be
forced to the full height of the padded area.
    %>
  <div class="w-full md:w-1/2 items-start bg-base-100 rounded-2xl flex flex-col p-8">

    <%# Header Image %>
    <div class="w-full h-48 bg-gradient-to-r from-primary to-secondary rounded-t-2xl mb-4">
      <!-- This would typically be a user's cover photo -->
    </div>

    <%# Profile Header %>
    <div class="flex flex-col items-center w-full mb-6 relative">
      <div class="avatar -mt-16 mb-4" data-controller="avatar-upload" data-avatar-upload-user-id-value="<%= @user.id %>" data-action="click->avatar-upload#selectFile dragover->avatar-upload#dragOver dragleave->avatar-upload#dragLeave drop->avatar-upload#drop">
        <div class="w-32 h-32 rounded-full ring ring-primary ring-offset-base-100 ring-offset-2 relative overflow-hidden group cursor-pointer">
          <% if @user.avatar.attached? %>
            <%= image_tag @user.avatar, class: "w-full h-full object-cover" %>
          <% else %>
            <div class="w-full h-full bg-neutral text-neutral-content flex items-center justify-center text-4xl">
              <%= @user.name[0].upcase %>
            </div>
          <% end %>
          <input type="file" accept="image/*" class="hidden" data-avatar-upload-target="fileInput" data-action="change->avatar-upload#uploadFile">
        </div>
        <div data-avatar-upload-target="progress" class="absolute inset-0 bg-primary bg-opacity-75 flex items-center justify-center text-white text-lg font-bold opacity-0 transition-opacity duration-200">0%</div>
      </div>
      
      <h1 class="text-3xl font-bold"><%= @user.name %></h1>
      <p class="text-neutral-500 mb-2">@<%= @user.name || @user.name.downcase.gsub(/\s+/, '') %></p>
      
      <% if @primary_dosha %>
        <div class="badge badge-lg <%= dosha_color_class(@primary_dosha) %> gap-2 mb-4">
          <%= @primary_dosha.name.titleize %>
        </div>
      <% end %>
    </div>

    <%# Bio Section %>
    <div class="w-full mb-6 text-center">
      <p class="text-lg mb-4">
        <%= @user.bio || "Welcome to my profile! I'm passionate about holistic health and Ayurveda." %>
      </p>
      
      <div class="flex justify-center gap-4 text-sm text-neutral-500 mb-4">
        <span><i class="fas fa-map-marker-alt mr-1"></i> <%= @user.location || 'Location not set' %></span>
        <span><i class="far fa-calendar-alt mr-1"></i> Joined <%= @user.created_at.strftime('%B %Y') %></span>
      </div>
    </div>

    <%# Stats Section %>
    <div class="flex justify-around w-full border-t border-b border-base-300 py-4 mb-6">
      <div class="text-center">
        <div class="font-bold text-xl">1,234</div>
        <div class="text-sm text-neutral-500">Posts</div>
      </div>
      <div class="text-center">
        <div class="font-bold text-xl">5.6K</div>
        <div class="text-sm text-neutral-500">Followers</div>
      </div>
      <div class="text-center">
        <div class="font-bold text-xl">789</div>
        <div class="text-sm text-neutral-500">Following</div>
      </div>
    </div>

    <%# Dosha Information - Kept from original but styled better %>
    <% if @primary_dosha %>
      <div class="w-full mb-6">
        <h3 class="text-xl font-semibold mb-3">Your Ayurvedic Profile</h3>
        <div class="prose">
          <p><%= t("doshas.#{@primary_dosha.name.downcase}.description") %></p>
          
          <h4 class="text-lg font-semibold mt-4">Key Characteristics</h4>
          <ul class="list-disc pl-5 space-y-1">
            <% t("doshas.#{@primary_dosha.name.downcase}.bullet_points").each do |point| %>
              <li><%= point %></li>
            <% end %>
          </ul>
          
          <div class="mt-4 space-y-2">
            <p><span class="font-semibold">When Balanced:</span> <%= t("doshas.#{@primary_dosha.name.downcase}.in_balance") %></p>
            <p><span class="font-semibold">When Unbalanced:</span> <%= t("doshas.#{@primary_dosha.name.downcase}.out_of_balance") %></p>
          </div>
        </div>
      </div>
    <% else %>
      <div class="alert alert-info">
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="stroke-current flex-shrink-0 w-6 h-6">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
          </svg>
          <span>Complete your Ayurvedic assessment to discover your dosha profile.</span>
        </div>
      </div>
    <% end %>

    <%# Tabs for different content sections %>
    <div class="tabs tabs-boxed bg-base-200 p-1 w-full mb-6">
      <a class="tab tab-active">Posts</a>
      <a class="tab">Media</a>
      <a class="tab">Likes</a>
      <a class="tab">Bookmarks</a>
    </div>

    <%# Content would go here %>
  </div>
