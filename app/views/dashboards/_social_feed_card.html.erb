<!-- Social Feed Card -->
<div class="card bg-base-100 border border-gray-300 h-full flex flex-col min-h-[450px] md:min-h-0 mb-0 md:mb-0">
  <div class="card-body p-0 flex flex-col flex-1 min-h-0">
    <!-- Feed Header -->
    <div class="p-4 border-b border-gray-200 flex items-start justify-between gap-3">
      <div>
        <h2 class="card-title text-lg font-semibold text-gray-800">
          Community Feed
        </h2>
        <p class="text-xs text-gray-500">Share your wins, struggles, questions â€” anything on your mind</p>
      </div>
      
    </div>
    
    <!-- Feed Content -->
    <div class="flex-1 flex flex-col min-h-0">
      <div class="relative flex-1 min-h-0">
        <div class="absolute inset-0">
          <div class="h-full overflow-y-auto" id="social-feed-scroll">
            <turbo-frame id="social_feed" src="<%= community_path %>" data-action="turbo:frame-render->scroll-to#scrollTop">
              <div class="flex items-center justify-center h-full">
                <span class="loading loading-spinner loading-lg"></span>
              </div>
            </turbo-frame>
          </div>
          <div class="pointer-events-none absolute bottom-0 left-0 right-0 h-4 bg-gradient-to-t from-base-100 to-transparent"></div>
        </div>
      </div>
      <div class="px-4 py-2 text-right">
        <%= link_to "View full feed", community_path, class: "link link-primary text-xs" %>
      </div>
    </div>
    
    <!-- New Post Form -->
    <div class="p-3 border-t border-gray-200">
      <%= turbo_frame_tag "new_post_form" do %>
        <%= form_with(model: SocialPost.new, url: social_posts_path, data: { turbo_frame: "social_feed", controller: "reset-form", action: "turbo:submit-end->reset-form#reset" }, class: "w-full") do |form| %>
          <div class="flex items-start gap-3">
            <div class="avatar placeholder">
              <div class="bg-gray-100 text-gray-500 rounded-full w-8 h-8 flex items-center justify-center text-xs font-medium">
                <%= Current.user.name.to_s.first&.upcase || Current.user.email_address.to_s.first&.upcase %>
              </div>
            </div>
            <div class="flex-1 relative">
              <div class="w-full flex items-center gap-2">
                <%= form.text_field :content, 
                                 class: "input input-bordered input-sm w-full flex-1", 
                                 placeholder: "Write something...", 
                                 required: true,
                                 autocomplete: "off",
                                 data: { action: "keydown.enter->reset-form#submitOnEnter" } %>
                <%= form.submit "Post", class: "btn btn-sm btn-primary normal-case" %>
              </div>
            </div>
          </div>
        <% end %>
      <% end %>
    </div>
  </div>
</div>
