<% content_for :main_container_class, 'bg-base-200' %>

<div class="container mx-auto px-4 py-8" data-controller="image-modal">
  <div class="max-w-2xl mx-auto">
    <!-- Header -->
    <div class="flex justify-between items-center mb-6">
      <div class="flex items-center gap-4">
        <div class="w-8 h-8 rounded-full" style="background-color: <%= @chronic_illness.color %>"></div>
        <div>
          <h1 class="text-3xl font-bold text-gray-900"><%= @chronic_illness.name %></h1>
          <% if @chronic_illness.sanskrit_name.present? %>
            <p class="text-lg text-gray-600 italic"><%= @chronic_illness.sanskrit_name %></p>
          <% end %>
        </div>
      </div>
      <div class="flex gap-2">
        <button onclick="toggleEditMode()" class="btn btn-primary btn-sm text-white" id="edit-btn">
          <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
          </svg>
          Edit Details
        </button>
        <%= link_to "Delete", admin_chronic_illness_path(@chronic_illness), method: :delete, 
                    class: "btn btn-error btn-sm text-white", 
                    data: { confirm: "Are you sure you want to delete #{@chronic_illness.name}?" } %>
      </div>
    </div>

    <!-- Quick Edit Form (Initially Hidden) -->
    <div id="edit-form" class="hidden mb-6" data-controller="inline-edit">
      <%= form_with(model: [:admin, @chronic_illness], local: true, id: "edit-form-element") do |form| %>
        <div class="card bg-base-100 border border-gray-300">
          <div class="card-body">
            <div class="space-y-6">
              <!-- Sanskrit Name -->
              <div class="form-control">
                <label class="label-text font-medium mb-2 text-gray-700">Sanskrit Name</label>
                <div class="flex items-center gap-2">
                  <%= form.text_field :sanskrit_name, 
                      class: "input input-bordered flex-1", 
                      placeholder: "e.g., Madhumeha",
                      data: { 
                        inline_edit_target: "field",
                        inline_edit_url_value: admin_chronic_illness_path(@chronic_illness),
                        inline_edit_field_name_value: "sanskrit_name"
                      } %>
                  <button type="button" onclick="addImage('sanskrit_name')" class="btn btn-ghost btn-sm" title="Add Image">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                    </svg>
                  </button>
                  <%= button_tag type: "button",
                      class: "btn btn-primary btn-sm text-white",
                      title: "Update Field",
                      data: {
                        action: "click->inline-edit#updateField",
                        inline_edit_target: "field",
                        inline_edit_url_value: admin_chronic_illness_path(@chronic_illness),
                        inline_edit_field_name_value: "sanskrit_name"
                      } do %>
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path>
                    </svg>
                  <% end %>
                </div>
              </div>

              <!-- Allopathic Description -->
              <div class="form-control">
                <label class="label-text font-medium mb-2 text-gray-700">Allopathic Description</label>
                <div class="flex items-start gap-2">
                  <div class="flex-1">
                    <%= form.rich_text_area :allo_description, class: "w-full", placeholder: "Medical description...",
                        data: {
                          inline_edit_target: "field",
                          inline_edit_url_value: admin_chronic_illness_path(@chronic_illness),
                          inline_edit_field_name_value: "allo_description"
                        } %>
                  </div>
                  <div class="flex flex-col gap-2 mt-1">
                    <button type="button" onclick="addImage('allo_description')" class="btn btn-ghost btn-sm" title="Add Image">
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                      </svg>
                    </button>
                    <%= button_tag type: "button",
                        class: "btn btn-primary btn-sm text-white",
                        title: "Update Field",
                        data: {
                          action: "click->inline-edit#updateField",
                          inline_edit_target: "field",
                          inline_edit_url_value: admin_chronic_illness_path(@chronic_illness),
                          inline_edit_field_name_value: "allo_description"
                        } do %>
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path>
                      </svg>
                    <% end %>
                  </div>
                </div>
              </div>

              <!-- Ayurvedic Description -->
              <div class="form-control">
                <label class="label-text font-medium mb-2 text-gray-700">Ayurvedic Description</label>
                <div class="flex items-start gap-2">
                  <div class="flex-1">
                    <%= form.rich_text_area :ayu_description, class: "w-full", placeholder: "Ayurvedic perspective...",
                        data: {
                          inline_edit_target: "field",
                          inline_edit_url_value: admin_chronic_illness_path(@chronic_illness),
                          inline_edit_field_name_value: "ayu_description"
                        } %>
                  </div>
                  <div class="flex flex-col gap-2 mt-1">
                    <button type="button" onclick="addImage('ayu_description')" class="btn btn-ghost btn-sm" title="Add Image">
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                      </svg>
                    </button>
                    <%= button_tag type: "button",
                        class: "btn btn-primary btn-sm text-white",
                        title: "Update Field",
                        data: {
                          action: "click->inline-edit#updateField",
                          inline_edit_target: "field",
                          inline_edit_url_value: admin_chronic_illness_path(@chronic_illness),
                          inline_edit_field_name_value: "ayu_description"
                        } do %>
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path>
                      </svg>
                    <% end %>
                  </div>
                </div>
              </div>

              <!-- Disease Evolution -->
              <div class="form-control">
                <label class="label-text font-medium mb-2 text-gray-700">Disease Evolution</label>
                <div class="flex items-start gap-2">
                  <div class="flex-1">
                    <%= form.rich_text_area :disease_evolution, class: "w-full", placeholder: "How the disease progresses...",
                        data: {
                          inline_edit_target: "field",
                          inline_edit_url_value: admin_chronic_illness_path(@chronic_illness),
                          inline_edit_field_name_value: "disease_evolution"
                        } %>
                  </div>
                  <div class="flex flex-col gap-2 mt-1">
                    <button type="button" onclick="addImage('disease_evolution')" class="btn btn-ghost btn-sm" title="Add Image">
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                      </svg>
                    </button>
                    <%= button_tag type: "button",
                        class: "btn btn-primary btn-sm text-white",
                        title: "Update Field",
                        data: {
                          action: "click->inline-edit#updateField",
                          inline_edit_target: "field",
                          inline_edit_url_value: admin_chronic_illness_path(@chronic_illness),
                          inline_edit_field_name_value: "disease_evolution"
                        } do %>
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path>
                      </svg>
                    <% end %>
                  </div>
                </div>
              </div>

              <!-- Effects -->
              <div class="form-control">
                <label class="label-text font-medium mb-2 text-gray-700">Effects</label>
                <div class="flex items-start gap-2">
                  <div class="flex-1">
                    <%= form.rich_text_area :effects, class: "w-full", placeholder: "Impact on Vata, Pitta, and Kapha...",
                        data: {
                          inline_edit_target: "field",
                          inline_edit_url_value: admin_chronic_illness_path(@chronic_illness),
                          inline_edit_field_name_value: "effects"
                        } %>
                  </div>
                  <div class="flex flex-col gap-2 mt-1">
                    <button type="button" onclick="addImage('effects')" class="btn btn-ghost btn-sm" title="Add Image">
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                      </svg>
                    </button>
                    <%= button_tag type: "button",
                        class: "btn btn-primary btn-sm text-white",
                        title: "Update Field",
                        data: {
                          action: "click->inline-edit#updateField",
                          inline_edit_target: "field",
                          inline_edit_url_value: admin_chronic_illness_path(@chronic_illness),
                          inline_edit_field_name_value: "effects"
                        } do %>
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path>
                      </svg>
                    <% end %>
                  </div>
                </div>
              </div>

              <!-- Causes -->
              <div class="form-control">
                <label class="label-text font-medium mb-2 text-gray-700">Causes</label>
                <div class="flex items-start gap-2">
                  <div class="flex-1">
                    <%= form.rich_text_area :causes, class: "w-full", placeholder: "Root causes and contributing factors...",
                        data: {
                          inline_edit_target: "field",
                          inline_edit_url_value: admin_chronic_illness_path(@chronic_illness),
                          inline_edit_field_name_value: "causes"
                        } %>
                  </div>
                  <div class="flex flex-col gap-2 mt-1">
                    <button type="button" onclick="addImage('causes')" class="btn btn-ghost btn-sm" title="Add Image">
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                      </svg>
                    </button>
                    <%= button_tag type: "button",
                        class: "btn btn-primary btn-sm text-white",
                        title: "Update Field",
                        data: {
                          action: "click->inline-edit#updateField",
                          inline_edit_target: "field",
                          inline_edit_url_value: admin_chronic_illness_path(@chronic_illness),
                          inline_edit_field_name_value: "causes"
                        } do %>
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path>
                      </svg>
                    <% end %>
                  </div>
                </div>
              </div>

              <!-- Manifestation -->
              <div class="form-control">
                <label class="label-text font-medium mb-2 text-gray-700">Manifestation</label>
                <div class="flex items-start gap-2">
                  <div class="flex-1">
                    <%= form.rich_text_area :manifestation, class: "w-full", placeholder: "How the condition manifests...",
                        data: {
                          inline_edit_target: "field",
                          inline_edit_url_value: admin_chronic_illness_path(@chronic_illness),
                          inline_edit_field_name_value: "manifestation"
                        } %>
                  </div>
                  <div class="flex flex-col gap-2 mt-1">
                    <button type="button" onclick="addImage('manifestation')" class="btn btn-ghost btn-sm" title="Add Image">
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                      </svg>
                    </button>
                    <%= button_tag type: "button",
                        class: "btn btn-primary btn-sm text-white",
                        title: "Update Field",
                        data: {
                          action: "click->inline-edit#updateField",
                          inline_edit_target: "field",
                          inline_edit_url_value: admin_chronic_illness_path(@chronic_illness),
                          inline_edit_field_name_value: "manifestation"
                        } do %>
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path>
                      </svg>
                    <% end %>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      <% end %>
    </div>

    <!-- Display Sections -->
    <div class="space-y-6">
      <!-- Sanskrit Name -->
      <% if @chronic_illness.sanskrit_name.present? %>
        <div class="card bg-base-100 border border-gray-300">
          <div class="card-body">
            <h3 class="card-title text-lg text-gray-900">Sanskrit Name</h3>
            <p class="text-lg text-gray-700 italic"><%= @chronic_illness.sanskrit_name %></p>
          </div>
        </div>
      <% end %>

      <!-- Allopathic Description -->
      <div class="card bg-base-100 border border-gray-300">
        <div class="card-body">
          <h3 class="card-title text-lg text-gray-900">Allopathic Description</h3>
          <% if @chronic_illness.allo_description.present? %>
            <div class="prose max-w-none text-gray-700">
              <%= @chronic_illness.allo_description %>
            </div>
          <% else %>
            <p class="text-gray-500 italic">No allopathic description provided</p>
          <% end %>
        </div>
      </div>

      <!-- Ayurvedic Description -->
      <div class="card bg-base-100 border border-gray-300">
        <div class="card-body">
          <h3 class="card-title text-lg text-gray-900">Ayurvedic Description</h3>
          <% if @chronic_illness.ayu_description.present? %>
            <div class="prose max-w-none text-gray-700">
              <%= @chronic_illness.ayu_description %>
            </div>
          <% else %>
            <p class="text-gray-500 italic">No ayurvedic description provided</p>
          <% end %>
        </div>
      </div>

      <!-- Disease Evolution -->
      <div class="card bg-base-100 border border-gray-300">
        <div class="card-body">
          <h3 class="card-title text-lg text-gray-900">Disease Evolution</h3>
          <% if @chronic_illness.disease_evolution.present? %>
            <div class="prose max-w-none text-gray-700">
              <%= @chronic_illness.disease_evolution %>
            </div>
          <% else %>
            <p class="text-gray-500 italic">No disease evolution information provided</p>
          <% end %>
        </div>
      </div>

      <!-- Effects -->
      <div class="card bg-base-100 border border-gray-300">
        <div class="card-body">
          <h3 class="card-title text-lg text-gray-900">Effects</h3>
          <% if @chronic_illness.effects.present? %>
            <div class="prose max-w-none text-gray-700">
              <%= @chronic_illness.effects %>
            </div>
          <% else %>
            <p class="text-gray-500 italic">No effects information provided</p>
          <% end %>
        </div>
      </div>

      <!-- Causes -->
      <div class="card bg-base-100 border border-gray-300">
        <div class="card-body">
          <h3 class="card-title text-lg text-gray-900">Causes</h3>
          <% if @chronic_illness.causes.present? %>
            <div class="prose max-w-none text-gray-700">
              <%= @chronic_illness.causes %>
            </div>
          <% else %>
            <p class="text-gray-500 italic">No causes information provided</p>
          <% end %>
        </div>
      </div>

      <!-- Manifestation -->
      <div class="card bg-base-100 border border-gray-300">
        <div class="card-body">
          <h3 class="card-title text-lg text-gray-900">Manifestation</h3>
          <% if @chronic_illness.manifestation.present? %>
            <div class="prose max-w-none text-gray-700">
              <%= @chronic_illness.manifestation %>
            </div>
          <% else %>
            <p class="text-gray-500 italic">No manifestation information provided</p>
          <% end %>
        </div>
      </div>

      <!-- Food Management -->
      <div class="card bg-base-100 border border-gray-300">
        <div class="card-body">
          <h2 class="card-title text-lg text-gray-900 mb-6">Food Management</h2>
          
          <!-- Healing Foods Section -->
          <div class="mb-8">
            <div class="flex justify-between items-center mb-4">
              <h3 class="text-lg font-semibold text-green-700">Healing Foods</h3>
              <button onclick="showAddFoodForm('healing')" class="btn btn-success btn-sm text-white">
                <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                </svg>
                Add Healing Food
              </button>
            </div>
            
            <!-- Add Healing Food Form (Initially Hidden) -->
            <div id="add-healing-food-form" class="hidden mb-4 p-4 bg-green-50 rounded-lg border border-green-200">
              <%= form_with url: add_healing_food_admin_chronic_illness_path(@chronic_illness), method: :post, local: true, class: "flex items-center gap-3" do |form| %>
                <div class="flex-1">
                  <%= form.text_field :food_name, 
                      placeholder: "Search or add a healing food...", 
                      class: "input input-bordered w-full",
                      list: "healing-foods-list",
                      autocomplete: "off" %>
                  <datalist id="healing-foods-list">
                    <% Food.all.each do |food| %>
                      <option value="<%= food.name %>">
                    <% end %>
                  </datalist>
                </div>
                <%= form.submit "Add", class: "btn btn-success btn-sm text-white" %>
                <button type="button" onclick="hideAddFoodForm('healing')" class="btn btn-ghost btn-sm">Cancel</button>
              <% end %>
            </div>
            
            <!-- Healing Foods List -->
            <div class="space-y-3">
              <% if @chronic_illness.healing_foods.any? %>
                <% @chronic_illness.healing_foods.each do |food| %>
                  <div class="flex items-center justify-between p-3 bg-green-50 rounded-lg border border-green-200">
                    <div class="flex-1">
                      <span class="font-semibold text-green-800 text-base"><%= food.name %></span>
                      <% if food.details.present? %>
                        <p class="text-sm text-green-600 mt-1"><%= truncate(food.details, length: 100) %></p>
                      <% end %>
                    </div>
                    <%= link_to "Remove", remove_healing_food_admin_chronic_illness_path(@chronic_illness, food_id: food.id), 
                        method: :delete, 
                        class: "btn btn-ghost btn-sm text-red-600 hover:text-red-800 hover:bg-red-50",
                        data: { confirm: "Remove #{food.name} from healing foods?" } %>
                  </div>
                <% end %>
              <% else %>
                <p class="text-gray-500 italic text-sm">No healing foods added yet.</p>
              <% end %>
            </div>
          </div>
          
          <!-- Aggravating Foods Section -->
          <div>
            <div class="flex justify-between items-center mb-4">
              <h3 class="text-lg font-semibold text-red-700">Aggravating Foods</h3>
              <button onclick="showAddFoodForm('aggravating')" class="btn btn-error btn-sm text-white">
                <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                </svg>
                Add Aggravating Food
              </button>
            </div>
            
            <!-- Add Aggravating Food Form (Initially Hidden) -->
            <div id="add-aggravating-food-form" class="hidden mb-4 p-4 bg-red-50 rounded-lg border border-red-200">
              <%= form_with url: add_aggravating_food_admin_chronic_illness_path(@chronic_illness), method: :post, local: true, class: "flex items-center gap-3" do |form| %>
                <div class="flex-1">
                  <%= form.text_field :food_name, 
                      placeholder: "Search or add an aggravating food...", 
                      class: "input input-bordered w-full",
                      list: "aggravating-foods-list",
                      autocomplete: "off" %>
                  <datalist id="aggravating-foods-list">
                    <% Food.all.each do |food| %>
                      <option value="<%= food.name %>">
                    <% end %>
                  </datalist>
                </div>
                <%= form.submit "Add", class: "btn btn-error btn-sm text-white" %>
                <button type="button" onclick="hideAddFoodForm('aggravating')" class="btn btn-ghost btn-sm">Cancel</button>
              <% end %>
            </div>
            
            <!-- Aggravating Foods List -->
            <div class="space-y-3">
              <% if @chronic_illness.aggravating_foods.any? %>
                <% @chronic_illness.aggravating_foods.each do |food| %>
                  <div class="flex items-center justify-between p-3 bg-red-50 rounded-lg border border-red-200">
                    <div class="flex-1">
                      <span class="font-semibold text-red-800 text-base"><%= food.name %></span>
                      <% if food.details.present? %>
                        <p class="text-sm text-red-600 mt-1"><%= truncate(food.details, length: 100) %></p>
                      <% end %>
                    </div>
                    <%= link_to "Remove", remove_aggravating_food_admin_chronic_illness_path(@chronic_illness, food_id: food.id), 
                        method: :delete, 
                        class: "btn btn-ghost btn-sm text-red-600 hover:text-red-800 hover:bg-red-50",
                        data: { confirm: "Remove #{food.name} from aggravating foods?" } %>
                  </div>
                <% end %>
              <% else %>
                <p class="text-gray-500 italic text-sm">No aggravating foods added yet.</p>
              <% end %>
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>
</div>

<script>
  function toggleEditMode() {
    const editForm = document.getElementById('edit-form');
    const editBtn = document.getElementById('edit-btn');
    
    if (editForm.classList.contains('hidden')) {
      editForm.classList.remove('hidden');
      editBtn.innerHTML = `
        <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
        </svg>
        Cancel Edit
      `;
      editBtn.classList.remove('btn-primary');
      editBtn.classList.add('btn-ghost');
    } else {
      editForm.classList.add('hidden');
      editBtn.innerHTML = `
        <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
        </svg>
        Edit Details
      `;
      editBtn.classList.remove('btn-ghost');
      editBtn.classList.add('btn-primary');
    }
  }



  function showAddFoodForm(type) {
    const form = document.getElementById(`add-${type}-food-form`);
    if (form) {
      form.classList.remove('hidden');
      // Focus on the input field
      const input = form.querySelector('input[type="text"]');
      if (input) {
        input.focus();
      }
    }
  }

  function hideAddFoodForm(type) {
    const form = document.getElementById(`add-${type}-food-form`);
    if (form) {
      form.classList.add('hidden');
      // Reset form
      const formElement = form.querySelector('form');
      if (formElement) {
        formElement.reset();
      }
    }
  }

  function addImage(fieldName) {
    // This function would handle adding images to rich text fields
    console.log('Adding image to field:', fieldName);
  }
</script>

<style>
  .prose img {
    border-radius: 0.5rem;
    cursor: pointer;
    transition: transform 0.2s ease-in-out;
  }
  
  .prose img:hover {
    transform: scale(1.02);
  }
  
  /* Ensure images in rich text areas are clickable */
  .prose img[data-action] {
    cursor: pointer;
  }
</style>