<% if social_post.present? %>
<div class="border-b border-gray-200 last:border-b-0 hover:bg-gray-100 transition-colors cursor-pointer" data-controller="social-post" data-action="click->social-post#openPost" data-social-post-url-value="<%= social_post_path(social_post) %>">
  <div class="px-3 py-2 sm:py-1 last:pb-0 mt-2 mb-2">
    <div class="flex items-start gap-2 mb-0.5 mt-1">
      <%= link_to user_path(social_post.user), 
                  class: "avatar placeholder hover:opacity-80 transition-opacity",
                  data: { action: "click->social-post#stopPropagation", turbo: false } do %>
        <div class="rounded-full w-5 h-5 overflow-hidden">
          <% if social_post.user.avatar.attached? %>
            <%= image_tag social_post.user.avatar, class: "w-full h-full object-cover" %>
          <% else %>
            <div class="w-full h-full bg-neutral text-neutral-content flex items-center justify-center text-[8px]">
              <%= (social_post.user.name.to_s.first&.upcase || social_post.user.email_address.to_s.first&.upcase) %>
            </div>
          <% end %>
        </div>
      <% end %>
      <div class="flex-1 min-w-0">
        <div class="flex items-center gap-1 mb-1">
          <h2 class="text-xs font-medium truncate">
            <%= link_to social_post.user.name.presence || social_post.user.email_address, 
                        user_path(social_post.user), 
                        class: "hover:text-blue-600 hover:underline transition-colors",
                        data: { action: "click->social-post#stopPropagation", turbo: false } %>
          </h2>
          <% ts = social_post.published_at || social_post.created_at %>
          <% if ts.present? %>
            <span class="text-[10px] text-gray-400">â€¢</span>
            <span class="text-[10px] text-gray-400"><%= time_ago_in_words(ts) %> ago</span>
          <% end %>
        </div>
        <div class="text-sm leading-tight">
          <%= social_post.content %>
        </div>
      </div>
      <% if social_post.media.attached? %>
        <div class="flex-shrink-0 w-12 h-12">
          <% media_item = social_post.media.first %>
          <% if media_item.image? %>
            <%= image_tag media_item, 
                         class: "w-12 h-12 object-cover object-top rounded border border-gray-200", 
                         alt: "Post image" %>
          <% elsif media_item.video? %>
            <div class="relative w-12 h-12 bg-gray-100 rounded border border-gray-200 flex items-center justify-center">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" />
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
              </svg>
            </div>
          <% else %>
            <div class="w-12 h-12 border border-gray-200 rounded flex items-center justify-center bg-gray-50">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z" />
              </svg>
            </div>
          <% end %>
        </div>
      <% end %>
    </div>
  </div>
</div>
<% end %>
